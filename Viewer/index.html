<!DOCTYPE html>
<html>
   <head>
      <meta charset="utf-8">
      <link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/create3000/cobweb/master/stable/1/1.19/cobweb.css"/>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.css">
      <script type="text/javascript" src="https://cdn.rawgit.com/create3000/cobweb/master/stable/1/1.19/cobweb.min.js"></script>
      <script type="text/javascript"  src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.js"> </script>
      <script type="text/javascript"  src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/mode/xml/xml.min.js"> </script>
      <script type="text/javascript"  src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/addon/edit/matchbrackets.min.js"> </script>
      <script type="text/javascript"  src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/addon/edit/matchtags.min.js"> </script>

   <style>
X3D {
   width: 100%;
   height: 400px;
}
   </style>
   </head>
   <body>
      <form>
         Edit and click outside the box to load:<button onclick='updatex3d();'>Update</button>
         <textarea name="x3dcontent" id='x3dcontent' rows="30" cols="120" onchanges='loadX3d("x3dele", event.target.value); console.log("changed");'>
Paste x3d here.</textarea>
      </form>
      <X3D id='x3dele' cache='false' url='  "https://raw.githubusercontent.com/andreasplesch/Library/master/Models/Animals/Bird.x3d"  '>
         <p>Your browser may not support all features required by Cobweb!</p>
      </X3D>
      <p>Here is an example to copy and paste:</p>
      <iframe width="100%" height="500px" src="http://x3dgraphics.com/examples/X3dForWebAuthors/Chapter02-GeometryPrimitives/Sphere.html"></iframe>
      <script>
         var editor = CodeMirror.fromTextArea(document.getElementById("x3dcontent"),
         {
            lineNumbers: true,
            mode: "xml",
            matchbrackets: true,
            matchtags: true
         });
         var x3dele = document.getElementById("x3dele");
         //var dataurl = "data:text/plain,base64;" + btoa(content);
         
         editor.on("update", function(){
            var content = editor.getDoc().getValue(); 
            browser.replaceWorld(browser.createX3DFromString(content));
         });
         
         function updatex3d() {
            var browser = X3D.getBrowser(x3dele);
            editor.save();
            var content = editor.getDoc().getValue(); 
            browser.replaceWorld(browser.createX3DFromString(content));
         }
         
         function loadX3d (id, content) {
            var x3dele = document.getElementById(id);
            var dataurl = "data:text/plain,base64;" + btoa(content);
            var browser = X3D.getBrowser(x3dele);
            browser.replaceWorld(browser.createX3DFromString(content));
         }
      </script>
   </body>
</html>
